# Шаблон для работы правильного 1С разработчика

* содержит выработанную и обдуманную семантически структуру каталогов
* содержит необходимые команды для быстрого старта
* является собственной интерпретацией https://github.com/vanessa-opensource/vanessa-bootstrap

**Оглавление**:

- [Шаблон для работы правильного 1С разработчика](#шаблон-для-работы-правильного-1с-разработчика)
  - [Быстрое использование](#быстрое-использование)
  - [Использование шаблона](#использование-шаблона)
    - [Порядок установки с подпиской на изменения](#порядок-установки-с-подпиской-на-изменения)
    - [Порядок обновления](#порядок-обновления)
    - [Порядок тестирования](#порядок-тестирования)
  - [Первичная настройка](#первичная-настройка)
  - [Использование tasks](#использование-tasks)
  - [Полезные команды](#полезные-команды)

## Быстрое использование

Самый простой и быстрый способ создания нового каталога проекта - это использования команды vanessa-runner

Запуск `vrunner init-project` в пустом каталоге создаст необходимую структуру проекта

Или используйте проект как набор каталогов и файлов, которые скопируете `ctrl + c` в свой каталог проекта `ctrl + v`

## Использование шаблона

### Порядок установки с подпиской на изменения

* переключитесь в пустой рабочий каталог своего продукта

```shell
cd название-вашего-продукта-1С
```

* клонируйте репозиторий

```shell
git clone https://github.com/johnnyshut/vanessa-bootstrap.git .
```

Важно: не потеряйте точку в конце строки команды

* подпишитесь на обновление шаблона

```shell
git remote add -f --no-tags -m --mirror bootstrap https://github.com/johnnyshut/vanessa-bootstrap.git
git remote remove origin
```

* подключите репозиторий к своему git серверу (GitHub, Bitbucket, GitLab, etc)

```shell
git remote add origin git://new.url.here
```

* получите изменения из своего репозитория

```shell
git pull origin ваша-ветка --allow-unrelated-histories
```

* исправьте полученные конфликты, если вы меняли те же файлы, что есть в шаблоне

теперь вы можете начинать разрабатывать по-правильному и быть подписанными на любые изменения.

### Порядок обновления

Чтобы получить изменения каталога

```shell
git pull bootstrap ваша-текущая-ветка-разработки
```

### Порядок тестирования

Если Вам нужно протестировать код который не помещали в систему управления версиями

* переключитесь в пустой рабочий каталог

```shell
cd название-вашего-каталога
```

* клонируйте репозиторий или скачайте

```shell
git clone https://github.com/johnnyshut/vanessa-bootstrap.git .
```

* откройте файл ```env.json``` и отредактируйте параметры запуска ([Первичная настройка](#первичная-настройка))

* копируйте файл ```tools\xUnitParams.json``` из удаленного репозитория проекта, чтобы включить исключения для дымовых тестов

* запустите дымовые тесты

```shell
xunit.cmd
```

* запустите сценарные тесты

```shell
vanessa.cmd
```

* запустите синтаксический контроль

```shell
syntax-check.cmd
```

* сформируйте и запустить allure отчет

```shell
allure-result.cmd
```

## Первичная настройка

* настройте файл [env.json](./env.json) для выполнения команд
  * задайте версию платформы 1С - ключ `--v8version`
  * задайте строку соединения dev ИБ - ключ `--ibconnection`
  * задайте строку доступ к этой ИБ - ключи `--db-user` и `--db-pwd`
  * скорректируйте настройку локализации - ключи `--locale` и `--language`
  * задайте вид клиента - ключ `--ordinaryapp` - тонкий (0), толстый (1) или без указания клиента (-1)
* сделайте отдельные файлы для отдельных команд, например, [tools/vrunner.json](./tools/vrunner.json)

## Использование tasks

Кроме запуска `*.cmd` файлов доступны tasks из функционала VSCode.
Нажмите `ctrl + shift + p` и выберите пункт "Task: Run Task"
Из выпадающего списка исполните необходимую команду

## Полезные команды

* установка локальных зависимостей
  * `prepare.cmd`
    * создастся каталог `oscript_modules`
    * выполнится локальная установка последних версий библиотек oscript, указанных в файле `packagedef`
* Инициализация эталонной ИБ из исходного кода проекта
  * `init.cmd`
    * в папке build создается cf из исходников
    * создается служебная ИБ в `build/ib` или той, что прописана в `env.json`
    * выполняется обновление в режиме 1С:Предприятие
* Обновление (сборка) из исходников
  * `update.cmd`
    * обновляется служебная ИБ
    * выполняется обновление в режиме 1С:Предприятие
* Сборка артефактов из исходников
  * `build.cmd`
    * в папке build создается cf из исходников
    * в папке build также могут создаваться расширения и другие внешние файлы
* Быстрый запуск синтаксического контроля
  * `syntax-check.cmd`
* Быстрый прогон BDD-сценариев в служебной ИБ
  * `vanessa.cmd`
* Быстрый прогон TDD-сценариев в служебной ИБ
  * `xunit.cmd`
* Быстро открыть служебную ИБ в режиме 1С:Предприятие
  * `enterprise.cmd`
* Быстро открыть служебную ИБ в режиме Конфигуратор
  * `designer.cmd`
* Быстро открыть allure отчет
  * `allure-result.cmd`

p.s. изучите содержание `*.cmd` файлов, в них есть полезные комментарии
